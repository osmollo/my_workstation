---

- name: "include vars file"
  include_vars:
    file: "{{ linux_distribution | lower }}.yml"

- name: "[FEDORA] Install Python3 packages"
  dnf:
    name: "{{ python_packages }}"
    state: present
    update_cache: true
  when: linux_distribution == "fedora"

- name: "[DEB] Install Python3 packages"
  apt:
    name: "{{ python_packages }}"
    state: present
    update_cache: true
    autoclean: true
  when: linux_distribution in ["ubuntu", "debian"]

- name: "[ARCH] Install Python3 packages"
  pacman:
    name: "{{ python_packages }}"
    state: present
    update_cache: true
  when: linux_distribution == "arch"

- when: linux_distribution != "ubuntu"
  block:
    - name: "Install setuptools python module"
      pip:
        name:
          - setuptools

    - name: "Install python modules"
      pip:
        name: "{{ python_modules }}"

- when: linux_distribution == "ubuntu"
  block:
    - name: "Install setuptools"
      apt:
        name: python3-setuptools
        state: present
        update_cache: true

    - name: "Install python modules"
      vars:
        prefix: "python3-"
        quitar:
          - pylint
          - docker-py
          - gitpython
        poner:
          - pylint-common
          - docker
          - git
        to_install: "{{ [prefix] | product(python_modules | difference(quitar) + poner) | map('join') | list }}"
      apt:
        name: "{{ to_install }}"
        state: present
        update_cache: true

---

# https://linuxfacil.mx/blog/neovim/como-configurar-neovim-como-vscode-para-python/

- when: linux_distribution in ['ubuntu', 'debian']
  block:
    - name: "[NEOVIM] Get latest version of neovim"
      uri:
        url: "{{ neovim_latest_url }}"
        follow_redirects: safe
        body_format: raw
      register: neovim_latest

    - name: "[NEOVIM] Set urls for neovim packages"
      vars:
        neovim_version: "{{ neovim_latest.url | urlsplit('path') | basename }}"
      set_fact:
        neovim_deb_package: "https://github.com/neovim/neovim/releases/download/{{ neovim_version }}/nvim-linux64.deb"

- name: "[NEOVIM] install for {{ linux_distribution }}"
  include_tasks: "neovim_{{ linux_distribution }}.yml"

- name: "[NEOVIM] Alternative link for neovim"
  alternatives:
    name: "{{ item.name }}"
    link: "{{ item.link }}"
    path: "{{ item.path }}"
  loop:
    - name: vi
      link: /usr/bin/vi
      path: /usr/bin/nvim
    - name: vim
      link: /usr/bin/vim
      path: /usr/bin/nvim
    - name: editor
      link: /usr/bin/editor
      path: /usr/bin/nvim
  when: linux_distribution != 'arch' 

- name: "[NEOVIM] install plugins"
  import_tasks: "neovim_plugins.yml"
  tags:
    - neovim_plugins
    - nvim_plugins

- name: "[NEOVIM] create alias"
  lineinfile:
    path: "{{ ansible_user_dir }}/.bash_aliases"
    line: "alias vim='nvim'"
    owner: "{{ ansible_user }}"
    group: "{{ ansible_user }}"
    create: true
